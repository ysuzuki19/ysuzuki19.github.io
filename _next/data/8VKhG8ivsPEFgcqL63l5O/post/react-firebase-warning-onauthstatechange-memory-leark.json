{"pageProps":{"toc":[{"content":"はじめに","slug":"はじめに","lvl":2,"i":0},{"content":"warning 状態","slug":"warning-状態","lvl":2,"i":1},{"content":"まずは修正の前後","slug":"まずは修正の前後","lvl":2,"i":2},{"content":"元コード","slug":"元コード","lvl":3,"i":3},{"content":"修正後コード","slug":"修正後コード","lvl":3,"i":4},{"content":"原因","slug":"原因","lvl":2,"i":5},{"content":"おわりに","slug":"おわりに","lvl":2,"i":6},{"content":"参考","slug":"参考","lvl":2,"i":7}],"source":{"compiledSource":"var i=Object.defineProperty,l=Object.defineProperties;var d=Object.getOwnPropertyDescriptors;var t=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;var m=(e,n,s)=>n in e?i(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,a=(e,n)=>{for(var s in n||(n={}))o.call(n,s)&&m(e,s,n[s]);if(t)for(var s of t(n))c.call(n,s)&&m(e,s,n[s]);return e},r=(e,n)=>l(e,d(n));var N=(e,n)=>{var s={};for(var p in e)o.call(e,p)&&n.indexOf(p)<0&&(s[p]=e[p]);if(e!=null&&t)for(var p of t(e))n.indexOf(p)<0&&c.call(e,p)&&(s[p]=e[p]);return s};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(s){var p=s,{components:e}=p,n=N(p,[\"components\"]);return mdx(MDXLayout,r(a(a({},layoutProps),n),{components:e,mdxType:\"MDXLayout\"}),mdx(\"h2\",a({},{id:\"\\u306F\\u3058\\u3081\\u306B\"}),mdx(\"a\",a({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#\\u306F\\u3058\\u3081\\u306B\"}),mdx(\"span\",a({parentName:\"a\"},{className:\"icon icon-link\"}))),\"\\u306F\\u3058\\u3081\\u306B\"),mdx(\"p\",null,\"React \\u3067 Firebase SDK \\u3092\\u4F7F\\u3063\\u3066\\u3044\\u3066\\uFF0C\\u30D6\\u30E9\\u30A6\\u30B6\\u306B\\u4EE5\\u4E0B\\u306E warning \\u304C\\u51FA\\u3066\\u304D\\u305F\\uFF0E\"),mdx(\"h2\",a({},{id:\"warning-\\u72B6\\u614B\"}),mdx(\"a\",a({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#warning-\\u72B6\\u614B\"}),mdx(\"span\",a({parentName:\"a\"},{className:\"icon icon-link\"}))),\"warning \\u72B6\\u614B\"),mdx(\"div\",a({},{className:\"remark-code-title\"}),\"warning_log\"),mdx(\"pre\",a({},{className:\"language-log\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-log\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"Warning:\"),\" Can't perform a React state update on an unmounted component\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\" This is a no\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"-\"),\"op\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" but it indicates a memory leak in your application\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\" To fix\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" cancel all subscriptions and asynchronous tasks in a useEffect cleanup function\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n`)),mdx(\"p\",null,\"\\u3053\\u306E\\u8B66\\u544A\\u306F\\uFF0C\\u898B\\u308B\\u9650\\u308A\\u30E1\\u30E2\\u30EA\\u30EA\\u30FC\\u30AF\\u304C\\u767A\\u751F\\u3057\\u3066\\u3044\\u308B\\uFF0E\\u30BF\\u30A4\\u30DF\\u30F3\\u30B0\\u3068\\u3057\\u3066\\u306F\\uFF0Ccomponent \\u306E unmount \\u6642\\u3067\\u3042\\u308B\\uFF0E\\u767A\\u751F\\u7B87\\u6240\\u306F\",mdx(\"inlineCode\",{parentName:\"p\"},\"useEffect()\"),\"\\u3068\\u306A\\u3063\\u3066\\u3044\\u308B\\uFF0E\"),mdx(\"p\",null,\"\\u4ECA\\u56DE\\u306F\\u5FC3\\u5F53\\u305F\\u308A\\u304C\\u5408\\u3063\\u305F\\u306E\\u3067\\u7C21\\u5358\\u306B\\u554F\\u984C\\u3092\\u4FEE\\u6B63\\u3067\\u304D\\u305F\\uFF0E\"),mdx(\"h2\",a({},{id:\"\\u307E\\u305A\\u306F\\u4FEE\\u6B63\\u306E\\u524D\\u5F8C\"}),mdx(\"a\",a({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#\\u307E\\u305A\\u306F\\u4FEE\\u6B63\\u306E\\u524D\\u5F8C\"}),mdx(\"span\",a({parentName:\"a\"},{className:\"icon icon-link\"}))),\"\\u307E\\u305A\\u306F\\u4FEE\\u6B63\\u306E\\u524D\\u5F8C\"),mdx(\"h3\",a({},{id:\"\\u5143\\u30B3\\u30FC\\u30C9\"}),mdx(\"a\",a({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#\\u5143\\u30B3\\u30FC\\u30C9\"}),mdx(\"span\",a({parentName:\"a\"},{className:\"icon icon-link\"}))),\"\\u5143\\u30B3\\u30FC\\u30C9\"),mdx(\"div\",a({},{className:\"remark-code-title\"}),\"base\"),mdx(\"pre\",a({},{className:\"language-tsx\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-tsx\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"const\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function-variable function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token maybe-class-name\"}),\"App\")),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token arrow operator\"}),\"=>\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token spread operator\"}),\"...\"),`\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"token method function property-access\"}),\"useEffect\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token arrow operator\"}),\"=>\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"onAuthStateChanged\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"auth\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token parameter\"}),\"user\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token arrow operator\"}),\"=>\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n      `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword control-flow\"}),\"if\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"user\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"setLoggedIn\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token boolean\"}),\"true\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"setImage\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"googlesignin_disabled\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n      `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword control-flow\"}),\"else\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"setLoggedIn\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n      `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\";\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword control-flow\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token spread operator\"}),\"...\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h3\",a({},{id:\"\\u4FEE\\u6B63\\u5F8C\\u30B3\\u30FC\\u30C9\"}),mdx(\"a\",a({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#\\u4FEE\\u6B63\\u5F8C\\u30B3\\u30FC\\u30C9\"}),mdx(\"span\",a({parentName:\"a\"},{className:\"icon icon-link\"}))),\"\\u4FEE\\u6B63\\u5F8C\\u30B3\\u30FC\\u30C9\"),mdx(\"div\",a({},{className:\"remark-code-title\"}),\"fixed\"),mdx(\"pre\",a({},{className:\"language-diff\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-diff\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token unchanged\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`const App = () => {\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`  ...\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`  useEffect(() => {\n`)),mdx(\"span\",a({parentName:\"code\"},{className:\"token deleted-sign deleted\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix deleted\"}),\"-\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`    onAuthStateChanged(auth, (user) => {\n`)),mdx(\"span\",a({parentName:\"code\"},{className:\"token inserted-sign inserted\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix inserted\"}),\"+\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`    const unsubscribe = onAuthStateChanged(auth, (user) => {\n`)),mdx(\"span\",a({parentName:\"code\"},{className:\"token unchanged\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`      if (user) {\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`        setLoggedIn(true);\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`        setImage(googlesignin_disabled);\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`      } else {\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`        setLoggedIn(false);\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`      }\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`    });\n`)),mdx(\"span\",a({parentName:\"code\"},{className:\"token inserted-sign inserted\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix inserted\"}),\"+\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`    return unsubscribe;\n`)),mdx(\"span\",a({parentName:\"code\"},{className:\"token unchanged\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`  }, []);\n`)),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token unchanged\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`  return (\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`    ...\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`  )\n`),mdx(\"span\",a({parentName:\"span\"},{className:\"token prefix unchanged\"}),\" \"),mdx(\"span\",a({parentName:\"span\"},{className:\"token line\"}),`}\n`)))),mdx(\"h2\",a({},{id:\"\\u539F\\u56E0\"}),mdx(\"a\",a({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#\\u539F\\u56E0\"}),mdx(\"span\",a({parentName:\"a\"},{className:\"icon icon-link\"}))),\"\\u539F\\u56E0\"),mdx(\"p\",null,mdx(\"inlineCode\",{parentName:\"p\"},\"useEffect()\"),\"\\u306B\\u3088\\u308A component \\u306E mount \\u6642\\u306B \",mdx(\"inlineCode\",{parentName:\"p\"},\"onAuthStateChanged()\"),\"\\u3067\\uFF0CAuth \\u72B6\\u614B\\u306E\\u5909\\u66F4\\u3092 subscribe \\u3057\\u3066\\u3044\\u305F\\uFF0E\"),mdx(\"p\",null,\"\\u5143\\u30B3\\u30FC\\u30C9\\u3067\\u306F subscribe \\u306E\\u89E3\\u9664\\u304C\\u884C\\u308F\\u308C\\u3066\\u3044\\u306A\\u3044\\uFF0E\\u305D\\u3053\\u3067\\uFF0C\",mdx(\"inlineCode\",{parentName:\"p\"},\"onAuthStateChanged()\"),\"\\u306E\\u623B\\u308A\\u5024\\u3067\\u3042\\u308B\",mdx(\"inlineCode\",{parentName:\"p\"},\"Unsubscribe\"),\"\\u578B\\u3092\\u4FDD\\u6301\\u3057\\u3066\\u304A\\u304D\\uFF0Cunmount \\u6642\\u306B\\u547C\\u3073\\u51FA\\u3059\\uFF0E\"),mdx(\"h2\",a({},{id:\"\\u304A\\u308F\\u308A\\u306B\"}),mdx(\"a\",a({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#\\u304A\\u308F\\u308A\\u306B\"}),mdx(\"span\",a({parentName:\"a\"},{className:\"icon icon-link\"}))),\"\\u304A\\u308F\\u308A\\u306B\"),mdx(\"p\",null,\"\\u300C\\u4F55\\u6545\\u3053\\u306E\\u66F8\\u304D\\u65B9\\u3092\\u3059\\u308B\\u3068\\u30FB\\u30FB\\u30FB\\uFF1F\\u300D\\u306A\\u3069\\u306E\\u7591\\u554F\\u306B\\u3064\\u3044\\u3066\\u306F\\uFF0C\\u304A\\u305D\\u3089\\u304F React \\u516C\\u5F0F\\u306E Hooks \\u306E\\u8AAC\\u660E\\u30DA\\u30FC\\u30B8\\u306E\\u4E2D\\u306E\",mdx(\"inlineCode\",{parentName:\"p\"},\"useEffect\"),\"\\u306E\\u8AAC\\u660E\\u3092\\u898B\\u3066\\u3082\\u3089\\u3048\\u3070\\u3088\\u3044\\u3067\\u3057\\u3087\\u3046\\uFF0E\\u65E5\\u672C\\u8A9E\\u3067\\u306F\\u300C\\u526F\\u4F5C\\u7528\\u30D5\\u30C3\\u30AF\\u300D\\u306E\\u3088\\u3046\\u306A\\u548C\\u8A33\\u304C\\u306A\\u3055\\u308C\\u3066\\u3044\\u305F\\u6C17\\u304C\\u3059\\u308B\\uFF0E\"),mdx(\"h2\",a({},{id:\"\\u53C2\\u8003\"}),mdx(\"a\",a({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#\\u53C2\\u8003\"}),mdx(\"span\",a({parentName:\"a\"},{className:\"icon icon-link\"}))),\"\\u53C2\\u8003\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"frontMatter":{"title":"reactのfirebaseSDKでmemory learkワーニング","date":"2021-09-20T19:46:54","description":"unmount時のsubscribe解除失敗問題の修正","tags":["react","firebase","memory leak","warning","unmount"]}},"__N_SSG":true}